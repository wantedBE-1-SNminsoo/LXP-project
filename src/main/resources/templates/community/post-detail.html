<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8" />
    <title th:text="${post.title}">게시글 상세</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body>
<div class="container">1

        <!-- 게시글 내용 및 액션 버튼 -->
        <div class="card">
            <div class="post-header">
                <h1 class="post-title" th:text="${post.title}">게시글 제목</h1>
                <div class="post-meta">
                    <span th:text="${post.author != null ? post.author.nickname : '탈퇴한 사용자'}">홍길동</span>
                    <span>&middot;</span>
                    <span th:text="${post.postType != null ? post.postType.name : 'N/A'}">FREE</span>
                </div>
            </div>
    
            <div class="post-content" th:text="${post.content}">
                게시글 내용
            </div>
    
            <div class="post-footer">
                <div class="post-date">
                    작성일: <span th:text="${#temporals.format(post.createdAt,'yyyy-MM-dd HH:mm')}">2025-11-13</span>
                    <span th:if="${post.updatedAt != null}">
                        &middot; 수정일: <span th:text="${#temporals.format(post.updatedAt,'yyyy-MM-dd HH:mm')}">2025-11-13</span>
                    </span>
                </div>
                <div class="post-actions">
                    <button class="btn secondary" type="button"
                            th:onclick="|location.href='@{/community/post}'|">
                        ← 목록으로
                    </button>
    
                    <div class="btn-group-right"
                         th:if="${loginUserId != null and post.author != null and post.author.id == loginUserId}">
                        <button class="btn secondary" type="button"
                                th:onclick="|location.href='@{/community/post/edit/{id}(id=${post.id})}'|">
                            수정
                        </button>
    
                        <form th:action="@{'/community/post/' + ${post.id} + '/delete'}"
                              method="post"
                              onsubmit="return confirm('정말 삭제하시겠습니까?');">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                            <button class="btn danger" type="submit">삭제</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    <!-- 댓글 목록 -->
    <div class="card">
        <h2>댓글</h2>

        <!-- 댓글 없을 때 -->
        <div th:if="${#lists.isEmpty(comments)}">
            아직 댓글이 없습니다.
        </div>

        <!-- 댓글 목록 -->
        <ul th:if="${!#lists.isEmpty(comments)}" style="list-style:none;padding:0;margin:0">
            <li th:each="c : ${comments}" style="border-bottom: 1px solid #eee; padding: 10px 0;">
                <div>
                    <strong th:text="${c.author != null ? c.author.nickname : '탈퇴한 사용자'}">작성자</strong>
                    <span style="font-size: 0.9em; color: #888; margin-left: 10px;"
                          th:text="${#temporals.format(c.createdAt,'yyyy-MM-dd HH:mm')}">
                        2025-11-13
                    </span>
                </div>
                <p style="margin-top: 5px;" th:text="${c.content}">
                    댓글 내용입니다.
                </p>
            </li>
        </ul>

        <!-- 댓글 작성 폼 -->
        <form method="post" th:action="@{/community/comment}">
            <input type="hidden" name="postId" th:value="${post.id}">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <textarea name="content" required rows="3"
                      placeholder="댓글을 입력하세요"></textarea>

            <button class="btn btn-primary" type="submit">댓글 작성</button>
        </form>
    </div>

</div>
</body>
</html>
