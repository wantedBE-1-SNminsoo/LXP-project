<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>ê°•ì¢Œ ìƒì„¸</title>
    <style>
        body { margin: 0; font-family: Arial, Helvetica, sans-serif; }
        .navbar { background-color: #2b2b2b; padding: 12px 24px; display: flex; gap: 18px; }
        .navbar a { color: white; text-decoration: none; font-size: 16px; }
        .navbar a:hover { text-decoration: underline; }
        .container { margin: 40px auto; width: 80%; }
        .course-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
        .course-card { border: 1px solid #aaa; padding: 20px; border-radius: 6px; height: 180px; }
        .course-card h3 { margin-top: 0; font-size: 18px; }
        .course-card a { display: inline-block; margin-top: 8px; color: #0066ff; text-decoration: none; }
        .course-card a:hover { text-decoration: underline; }
    </style>
</head>
<body>
<nav class="navbar">
    <a th:href="@{/courses}">Courses</a>
    <a th:href="@{/users/me}">My Page</a>
    <a th:href="@{/auth/login}">Logout</a>
    <a th:href="@{/community}">Community</a>
    <a th:href="@{/}">Home</a>

</nav>
<h1 th:text="${course.title}">ê°•ì¢Œ ì œëª©</h1>

<div>
    <p><strong>ì„¤ëª…:</strong> <span th:text="${course.description}">ê°•ì¢Œ ì„¤ëª…</span></p>
    <p><strong>ê°€ê²©:</strong> <span th:text="${course.price}">50000</span></p>
    <p><strong>ìƒíƒœ:</strong> <span th:text="${course.courseStatus}">ACTIVE</span></p>
    <p><strong>ì¹´í…Œê³ ë¦¬:</strong> <span th:text="${course.category?.name}">í”„ë¡œê·¸ë˜ë°</span></p>
    <p><strong>ê°•ì‚¬:</strong> <span th:text="${course.instructor?.nickname}">ê°•ì‚¬ëª…</span></p>
    <p><strong>ìƒì„±ì¼:</strong> <span th:text="${#temporals.format(course.createdAt, 'yyyy-MM-dd HH:mm')}"></span></p>
</div>
<!-- ìˆ˜ê°• ìƒíƒœì— ë”°ë¥¸ ë²„íŠ¼ í‘œì‹œ (null ì•ˆì „ ì²˜ë¦¬) -->
<div class="action-buttons">
    <!-- ìˆ˜ê°• ì¤‘ì¸ ê²½ìš° -->
    <a th:if="${isEnrolled != null and isEnrolled}"
       th:href="@{/learning/courses/{id}/lectures(id=${course.id})}"
       class="btn-primary">
        ğŸ“š ìˆ˜ê°•í•˜ëŸ¬ ê°€ê¸°
    </a>

    <!-- ìˆ˜ê°• ì¤‘ì´ ì•„ë‹Œ ê²½ìš° (isEnrolledê°€ nullì´ê±°ë‚˜ falseì¸ ê²½ìš°) -->
    <form th:if="${isEnrolled == null or !isEnrolled}"
          th:action="@{/cart/add/{courseId}(courseId=${course.id})}"
          method="post"
          style="display: inline;">
        <button type="submit" class="btn-success">ğŸ›’ ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°</button>
    </form>
</div>


<h2>ê°•ì˜ ëª©ë¡</h2>
<table border="1">
    <thead>
    <tr>
        <th>ìˆœì„œ</th>
        <th>ê°•ì˜ëª…</th>
        <th>URL</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="lecture : ${course.lectures}">
        <td th:text="${lecture.lectureOrder}">1</td>
        <td th:text="${lecture.title}">ê°•ì˜ ì œëª©</td>
        <td th:text="${lecture.contentUrl}">URL</td>
    </tr>
    </tbody>
</table>

<div>
    <a th:href="@{/courses/{id}/edit(id=${course.id})}">ìˆ˜ì •</a>
    <a href="/courses">ëª©ë¡ìœ¼ë¡œ</a>
</div>

<script th:inline="javascript">
    // Flash Attributeë¡œ ì „ë‹¬ëœ 'errorMessage' ë³€ìˆ˜ë¥¼ Thymeleafê°€ JavaScript ë³€ìˆ˜ë¡œ ë³€í™˜
    const errorMessage = /*[[${errorMessage}]]*/ 'default message';

    // ë©”ì‹œì§€ê°€ nullì´ê±°ë‚˜ ë¹„ì–´ìˆì§€ ì•Šì€ì§€ í™•ì¸í•©ë‹ˆë‹¤.
    // Flash AttributeëŠ” ì‚¬ìš© í›„ ì‚¬ë¼ì§€ë¯€ë¡œ, ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ ë‹¨ í•œ ë²ˆë§Œ ë©”ì‹œì§€ê°€ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤.
    if (errorMessage && errorMessage !== 'default message') {
        alert(errorMessage);
    }
</script>
</body>
</html>
